parcelRequire=function(t,e,n,i){var o,r="function"==typeof parcelRequire&&parcelRequire,a="function"==typeof require&&require;function s(n,i){if(!e[n]){if(!t[n]){var o="function"==typeof parcelRequire&&parcelRequire;if(!i&&o)return o(n,!0);if(r)return r(n,!0);if(a&&"string"==typeof n)return a(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}d.resolve=function(e){return t[n][1][e]||e},d.cache={};var u=e[n]=new s.Module(n);t[n][0].call(u.exports,d,u,u.exports,this)}return e[n].exports;function d(t){return s(d.resolve(t))}}s.isParcelRequire=!0,s.Module=function(t){this.id=t,this.bundle=s,this.exports={}},s.modules=t,s.cache=e,s.parent=r,s.register=function(e,n){t[e]=[function(t,e){e.exports=n},{}]};for(var c=0;c<n.length;c++)try{s(n[c])}catch(t){o||(o=t)}if(n.length){var u=s(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=u:"function"==typeof define&&define.amd?define(function(){return u}):this[i]=u}if(parcelRequire=s,o)throw o;return s}({tbHD:[function(t,e,n){"use strict";function i(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}var o;Object.defineProperty(n,"__esModule",{value:!0}),n.assign=function(t){return{type:"xstate.assign",assignment:t}},n.createMachine=function(t,e){void 0===e&&(e={});var n=i(f(a(t.states[t.initial].entry).map(function(t){return s(t,e.actions)}),t.context,r),2),o=n[0],l=n[1],p={config:t,_options:e,initialState:{value:t.initial,actions:o,context:l,matches:c(t.initial)},transition:function(e,n){var o,r,l="string"==typeof e?{value:e,context:t.context}:e,v=l.value,m=l.context,y=u(n),g=t.states[v];if(g.on){var h=a(g.on[y.type]);try{for(var I=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}(h),S=I.next();!S.done;S=I.next()){var N=S.value;if(void 0===N)return d(v,m);var b="string"==typeof N?{target:N}:N,x=b.target,T=void 0===x?v:x,R=b.actions,O=void 0===R?[]:R,L=b.cond;if((void 0===L?function(){return!0}:L)(m,y)){var A=t.states[T],$=i(f([].concat(g.exit,O,A.entry).filter(function(t){return t}).map(function(t){return s(t,p._options.actions)}),m,y),3),_=$[0],E=$[1],B=$[2];return{value:T,context:E,actions:_,changed:T!==v||_.length>0||B,matches:c(T)}}}}catch(t){o={error:t}}finally{try{S&&!S.done&&(r=I.return)&&r.call(I)}finally{if(o)throw o.error}}}return d(v,m)}};return p},n.interpret=function(t){var e=t.initialState,n=o.NotStarted,i=new Set,a={_machine:t,send:function(r){n===o.Running&&(e=t.transition(e,r),l(e,u(r)),i.forEach(function(t){return t(e)}))},subscribe:function(t){return i.add(t),t(e),{unsubscribe:function(){return i.delete(t)}}},start:function(i){if(i){var s="object"==typeof i?i:{context:t.config.context,value:i};e={value:s.value,actions:[],context:s.context,matches:c(s.value)}}return n=o.Running,l(e,r),a},stop:function(){return n=o.Stopped,i.clear(),a},get state(){return e},get status(){return n}};return a},n.InterpreterStatus=void 0,n.InterpreterStatus=o,function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"}(o||(n.InterpreterStatus=o={}));var r={type:"xstate.init"};function a(t){return void 0===t?[]:[].concat(t)}function s(t,e){return"string"==typeof(t="string"==typeof t&&e&&e[t]?e[t]:t)?{type:t}:"function"==typeof t?{type:t.name,exec:t}:t}function c(t){return function(e){return t===e}}function u(t){return"string"==typeof t?{type:t}:t}function d(t,e){return{value:t,context:e,actions:[],changed:!1,matches:c(t)}}function f(t,e,n){var i=e,o=!1;return[t.filter(function(t){if("xstate.assign"===t.type){o=!0;var e=Object.assign({},i);return"function"==typeof t.assignment?e=t.assignment(i,n):Object.keys(t.assignment).forEach(function(o){e[o]="function"==typeof t.assignment[o]?t.assignment[o](i,n):t.assignment[o]}),i=e,!1}return!0}),i,o]}var l=function(t,e){return t.actions.forEach(function(n){var i=n.exec;return i&&i(t.context,e)})}},{}],UyEN:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.saveShoppingListInLocalStorage=n.getShoppingListFromStorage=void 0;n.getShoppingListFromStorage=function(t,e){return function(){var n=t.getItem(e)||"[]";return JSON.parse(n)}};n.saveShoppingListInLocalStorage=function(t,e){return function(i){try{t.setItem(e,JSON.stringify(i))}catch(t){console.error(t)}return n.getShoppingListFromStorage(t,e)()}}},{}],dUY9:[function(t,e,n){"use strict";var i=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n},o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i};Object.defineProperty(n,"__esModule",{value:!0}),n.RecipeShoppingList=void 0;var r=t("@xstate/fsm"),a=t("./store");n.RecipeShoppingList=function(t){var e=t.handleAddItem,n=t.handleRemoveItem,s=(t.handleNotMember,i(t,["handleAddItem","handleRemoveItem","handleNotMember"])),c=a.getShoppingListFromStorage(localStorage,s.LS_KEY),u=a.saveShoppingListInLocalStorage(localStorage,s.LS_KEY),d=s.numIngredientsInRecipe,f=s.$servings,l=s.$addToBtn,p=s.$removeFromBtn,v=s.$shoppingListNotification,m=s.$toastNotification,y=v.querySelector("div");return r.createMachine({initial:s.initial,context:{$addToBtn:l,$removeFromBtn:p,$servings:f,$numItems:y,$toastNotification:m,recipeId:s.recipeId,numIngredientsInRecipe:d},states:{onlyInit:{entry:["updateNotificationIcon"],on:{UPDATE_NOTIFICATION:{actions:["updateNotificationIcon"]}}},empty:{entry:["updateNotificationIcon","displayAddButton"],exit:["hideAddButton"],on:{ADD:{target:"hasRecipe",actions:["addRecipeAndSaveList","updateNotificationIcon","displayAddToastNotification"]},UPDATE_NOTIFICATION:{actions:["updateNotificationIcon"]}}},hasRecipe:{entry:["updateNotificationIcon","displayRemoveButton"],exit:["hideRemoveButton"],on:{REMOVE:{target:"empty",actions:["removeRecipeAndSaveList","updateNotificationIcon","displayRemoveToastNotification"]},UPDATE_NOTIFICATION:{actions:["updateNotificationIcon"]}}}}},{actions:{addRecipeAndSaveList:function(t){var e,n=parseInt((null===(e=t.$servings)||void 0===e?void 0:e.value)||"1",10),i=c(),r=o(i,[{version:"1",id:t.recipeId,servings:n,totalIngredients:d}]);u(r)},displayAddButton:function(t){t.$addToBtn.style.display="flex",t.$addToBtn.addEventListener("click",e)},displayRemoveButton:function(t){t.$removeFromBtn.style.display="flex",t.$removeFromBtn.addEventListener("click",n)},displayAddToastNotification:function(t){t.$toastNotification.classList.value="added",t.$toastNotification.innerHTML="<div>"+s.translations.recipeHasBeenAdded+"</div>",delete t.$toastNotification.dataset.visible,requestAnimationFrame(function(){t.$toastNotification.dataset.visible=""}),clearTimeout(t.toastTimeout),t.toastTimeout=setTimeout(function(){delete t.$toastNotification.dataset.visible},4e3)},displayRemoveToastNotification:function(t){t.$toastNotification.classList.value="removed",t.$toastNotification.innerHTML="<div>"+s.translations.recipeHasBeenRemoved+"</div>",delete t.$toastNotification.dataset.visible,requestAnimationFrame(function(){t.$toastNotification.dataset.visible=""}),clearTimeout(t.toastTimeout),t.toastTimeout=setTimeout(function(){delete t.$toastNotification.dataset.visible},4e3)},hideAddButton:function(t){t.$addToBtn.style.display="none",t.$addToBtn.removeEventListener("click",e)},hideRemoveButton:function(t){t.$removeFromBtn.style.display="none",t.$removeFromBtn.removeEventListener("click",n)},removeRecipeAndSaveList:function(t){var e=c().filter(function(e){return e.id!==t.recipeId});u(e)},updateNotificationIcon:function(t){var e=c().reduce(function(t,e){var n;return t+(e.raw?e.raw.shoppingList.reduce(function(t,e){return e.completed||e.hidden?t:t+1},0):null!==(n=e.totalIngredients)&&void 0!==n?n:0)},0);t.$numItems.dataset.numIngredientsInRecipe=e.toString(),t.$numItems.innerText=e>99?"+99":""+e}}})}},{"@xstate/fsm":"tbHD","./store":"UyEN"}],QCba:[function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.use=void 0;var o=t("@xstate/fsm"),r=t("./shopping"),a=t("./store");n.use=function(t){var e,n="dd/recipes-shopping-list",s=a.getShoppingListFromStorage(localStorage,n)(),c=null!==(e=t.recipeId)&&void 0!==e&&e,u=!!c&&s.filter(function(e){return e.id===t.recipeId}).length>0,d=c?u?"hasRecipe":"empty":"onlyInit",f=o.interpret(r.RecipeShoppingList(i(i({initial:d,LS_KEY:n},t),{handleAddItem:function(t){t.preventDefault(),f.send({type:"ADD"})},handleRemoveItem:function(t){t.preventDefault(),f.send({type:"REMOVE"})},handleNotMember:function(t){t.preventDefault(),f.send({type:"ADD"})}}))).start();return document.addEventListener("visibilitychange",function(){document.hidden||f.send({type:"UPDATE_NOTIFICATION"})},!1),{updateNotification:function(){f.send({type:"UPDATE_NOTIFICATION"})}}}},{"@xstate/fsm":"tbHD","./shopping":"dUY9","./store":"UyEN"}]},{},["QCba"],"ShoppingList");
//# sourceMappingURL=recipes-shopping-list.min.js.map
